<!doctype html>
<html lang="ko">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover" />
  <title>1→6 순서 터치 (화이트 테마)</title>
  <style>
    :root{
      --bg:#ffffff; --cell:#ffffff; --cell2:#f2f2f2;
      --ok:#22c55e; --err:#ef4444; --ink:#000000; --muted:#555555;
      --panel:#ffffffee; --border:#00000033;
    }
    *{box-sizing:border-box}
    html,body{height:100%;margin:0}
    body{
      background: var(--bg); color: var(--ink);
      font-family: ui-sans-serif, system-ui, -apple-system, "Segoe UI", Roboto, "Noto Sans KR", "Apple SD Gothic Neo", "Malgun Gothic", Arial, sans-serif;
      -webkit-tap-highlight-color: transparent; user-select:none; touch-action: manipulation; overflow: hidden;
    }
    .hud{
      position: fixed; left:0; right:0; top:0; z-index: 3;
      display:flex; flex-wrap: wrap; align-items:center; justify-content:center; gap:8px 10px;
      padding: calc(8px + env(safe-area-inset-top)) 10px 8px;
      background: linear-gradient(180deg, rgba(255,255,255,.9), rgba(255,255,255,.6) 40%, transparent);
      font-variant-numeric: tabular-nums;
    }
    .row{ display:flex; gap:8px; align-items:center; flex-wrap:wrap; justify-content:center; }
    .pill{ background:#0000000a; border:1px solid #00000020; padding:6px 10px; border-radius:999px; }
    .pill strong{letter-spacing:.3px}
    .btn{ border:1px solid #00000030; background:#00000010; color:var(--ink); padding:10px 14px; border-radius:12px; font-weight:700; }
    .name{ display:flex; gap:6px; align-items:center; background:#00000008; border:1px solid #00000020; padding:6px 10px; border-radius:999px; }
    .name input{ background:transparent; border:none; outline:none; color:var(--ink); width:150px; font-weight:700; font-size:16px; }
    .status{ font-size:12px; color:var(--muted); }
    .status.ok{ color: var(--ok); } .status.err{ color: var(--err); }
    .toast{ position: fixed; inset: auto 0 calc(8px + env(safe-area-inset-bottom)) 0; display:flex; justify-content:center; padding: 6px 0; pointer-events:none; z-index:4; }
    .toast .box{ background:#00000033; border:1px solid #00000026; padding:8px 12px; border-radius:12px; font-variant-numeric: tabular-nums; }
    .good{color:var(--ok)} .bad{color:var(--err)}
    .grid{
      position: fixed; left:0; right:0; z-index:1;
      display:grid; grid-template-columns: repeat(3, 1fr); grid-template-rows: repeat(2, 1fr);
    }
    .cell{
      display:flex; align-items:center; justify-content:center;
      font-size: clamp(44px, 14vw, 120px); font-weight: 900; letter-spacing: .5px;
      border: 1px solid #00000018;
      background: var(--cell);
      transition: transform .02s ease, filter .2s ease, background .3s ease, outline-color .1s ease;
      color: var(--ink);
    }
    .cell:active{ transform: scale(.985) }
    .cell.done{ outline: 4px solid #22c55e55; filter: brightness(1.1); }
    .grid.shake{ animation:shake .25s linear }
    @keyframes shake{ 15%, 45%, 75% { transform: translateX(-6px) } 30%, 60%, 90% { transform: translateX(6px) } }
    .sr-only{ position:absolute; width:1px; height:1px; clip:rect(0 0 0 0); white-space:nowrap; overflow:hidden; }

    /* Intro overlay */
    .intro{
      position: fixed; inset:0; z-index: 10;
      display:flex; align-items:center; justify-content:center;
      background: rgba(0,0,0,.5);
      padding: 20px;
    }
    .intro .sheet{
      width: min(720px, 96vw);
      background: #ffffff;
      border: 1px solid var(--border);
      border-radius: 16px;
      box-shadow: 0 10px 30px #00000033;
      padding: 16px;
      color: #000;
    }
    .intro h2{ margin: 0 0 8px 0; font-size: 18px; }
    .intro p{ margin: 6px 0; line-height: 1.5; }
    .intro .note{ color:#16a34a; font-weight:600; } /* green accent */
    .intro .actions{ display:flex; justify-content:flex-end; gap:8px; margin-top:12px; }
  </style>
</head>
<body>
  <div id="hud" class="hud" aria-live="polite">
    <div class="row">
      <div class="name">
        <span>이름</span>
        <input id="playerName" placeholder="예: JI-YONG" maxlength="24" autocomplete="off" autocapitalize="none">
        <button class="btn" id="saveNameBtn" type="button">저장</button>
      </div>
      <button class="btn" id="restartBtn" type="button" aria-label="다시하기">↻ 다시</button>
      <button class="btn" id="leaderBtn" type="button" aria-label="랭킹">🏆 랭킹</button>
    </div>
    <div class="row">
      <div class="pill">시간 <strong id="time">0.000s</strong></div>
      <div class="pill">Best <strong id="best">—</strong></div>
      <div class="pill status" id="serverStatus">서버: 미설정</div>
    </div>
  </div>

  <div class="grid" id="grid" aria-label="터치 그리드 (1부터 6까지 순서대로 누르기)"></div>

  <div class="toast" aria-live="polite">
    <div class="box" id="msg"><span class="sr-only">힌트: </span><b>1</b>을 터치하면 시작</div>
  </div>

  <!-- Intro overlay -->
  <div class="intro" id="intro">
    <div class="sheet">
      <h2>게임 안내</h2>
      <p>1. 초록색 <span class="note">'서버:연결됨'</span>을 확인 후 시작하세요.</p>
      <p>2. 숫자 1을 누르는 순간 타이머가 시작됩니다.(누르기 전에는 시간 흐르지 않음.)</p>
      <p>3. 랭킹에 올리고 싶은 경우 이름을 입력하고 '저장'을 누르세요.</p>
      <p>4. '랭킹' 버튼을 누르면 Top10 기록이 표시됩니다.</p>
      <div class="actions">
        <button class="btn" id="introOk" type="button">확인</button>
      </div>
    </div>
  </div>

  <script>
    const API_BASE = "PUT_YOUR_APPS_SCRIPT_WEB_APP_URL_HERE";
    const $ = s => document.querySelector(s);
    const $$ = s => Array.from(document.querySelectorAll(s));

    const hud = $('#hud');
    const grid = $('#grid');
    const timeEl = $('#time');
    const bestEl = $('#best');
    const msgEl = $('#msg');
    const nameInput = $('#playerName');
    const saveNameBtn = $('#saveNameBtn');
    const serverStatus = $('#serverStatus');
    const intro = $('#intro'); const introOk = $('#introOk');

    let next=1,running=false,startTime=0,raf=null;
    const LS_NAME='sixSplitPlayerName';

    function resizeLayout(){grid.style.top=hud.offsetHeight+'px';grid.style.bottom='0px';}
    window.addEventListener('resize',resizeLayout);
    window.addEventListener('orientationchange',()=>setTimeout(resizeLayout,200));

    function init(){
      const stored=localStorage.getItem(LS_NAME)||'';if(stored)nameInput.value=stored;
      bind();render();reset(false);resizeLayout();
    }
    function bind(){
      introOk.addEventListener('click',()=>intro.style.display='none');
      $('#restartBtn').addEventListener('click',()=>{render();reset(true)});
    }
    function render(){grid.innerHTML='';[1,2,3,4,5,6].sort(()=>Math.random()-.5).forEach(n=>{const b=document.createElement('button');b.className='cell';b.type='button';b.dataset.num=n;b.textContent=n;b.addEventListener('pointerdown',tap,{passive:true});grid.appendChild(b)});}
    function tap(e){if(intro.style.display!=='none')return;const v=Number(e.currentTarget.dataset.num);if(v!==next){wrong();return;}e.currentTarget.classList.add('done');if(next===1){startTimer();msgEl.textContent='진행 중…';}if(next===6){finish();return;}next++;}
    function startTimer(){running=true;startTime=performance.now();if(raf)cancelAnimationFrame(raf);const tick=()=>{if(!running)return;timeEl.textContent=((performance.now()-startTime)/1000).toFixed(3)+'s';raf=requestAnimationFrame(tick)};raf=requestAnimationFrame(tick);}
    function stopTimer(){running=false;if(raf)cancelAnimationFrame(raf);raf=null;}
    function finish(){stopTimer();const elapsed=performance.now()-startTime;timeEl.textContent=(elapsed/1000).toFixed(3)+'s';msgEl.innerHTML='<span class="good">완료!</span>';next=999;}
    function wrong(){grid.classList.add('shake');msgEl.innerHTML='<span class="bad">순서 오류</span>';setTimeout(()=>grid.classList.remove('shake'),260);reset(false);}
    function reset(){stopTimer();next=1;timeEl.textContent='0.000s';$$('.cell').forEach(c=>c.classList.remove('done'));msgEl.innerHTML='<b>1</b>을 터치하면 시작';}
    init();
  </script>
</body>
</html>
